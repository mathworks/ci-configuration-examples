version: 2.1
orbs:
  matlab: mathworks/matlab@1
jobs:
  build:
    machine:
      image: ubuntu-2204:current
    steps:
      - checkout
      - run:
          name: Update hosts file
          command: |
            echo "23.200.240.12 www.mathworks.com" | sudo tee -a /etc/hosts
      - run:
          name: Confirm DNS resolution
          command: |
            ping -c 1 www.mathworks.com || true
            nslookup www.mathworks.com || true
      - matlab/install:
          products: Optimization_Toolbox Curve_Fitting_Toolbox
      - matlab/run-tests:
          source-folder: code

      # As an alternative to run-tests, you can use run-command to execute a MATLAB script, function, or statement.
      # - matlab/run-command:
      #     command: addpath('code'); results = runtests('IncludeSubfolders', true); assertSuccess(results);
